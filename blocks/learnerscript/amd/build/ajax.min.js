define ("block_learnerscript/ajax",["jquery","core/config","core/log","core/modal_factory"],function(a,b,c,d){var e=!1,f=function(a){var b=this;if(null===a){return}if(a.error){if(a.cap||a.debuginfo||a.errorcode){var e=a.msg||a.error;d.create({title:a.type||a.errorcode,body:"<p>"+e+"</p>",footer:""}).done(function(a){dialogue=a;dialogue.show()})}else{c.error(a.type+": "+a.msg)}b.deferred.reject(a);return}if("undefined"!=typeof a){b.deferred.resolve(a)}else{exception=new Error("missing response")}if("undefined"!=typeof exception&&null!==exception){b.deferred.reject(exception)}},g=function(a,b,d){var f=this;if(e){c.error("Page unloaded.");c.error(d)}else{c.error("Page Not Responding.");c.error(d);f.deferred.reject(d)}};return{call:function call(c,d,h){a(window).bind("beforeunload",function(){e=!0});var i,j={};if("undefined"==typeof h){h=!0}if("undefined"==typeof d){d=!0}i=c.args;c.deferred=a.Deferred();j=c.deferred.promise();if("undefined"!=typeof c.done){c.deferred.done(c.done)}if("undefined"!=typeof c.fail){c.deferred.fail(c.fail)}i=JSON.stringify(i);var k={type:"POST",data:i,context:c,dataType:"json",processData:!1,global:!0,async:d,contentType:"application/json",beforeSend:function beforeSend(){c.loading&&a(c.loading).show()},success:function success(){c.loading&&a(c.loading).hide("fast")}};if(d){a.ajax(c.url+"?sesskey="+b.sesskey,k).done(f).fail(g)}else{k.success=f;k.error=g;a.ajax(c.url+"?sesskey="+b.sesskey,k)}return j}}});
//# sourceMappingURL=ajax.min.js.map
